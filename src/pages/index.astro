---
import Layout from '../layouts/Layout.astro';
import SocialLinks from '../components/SocialLinks.astro';
import BlogPostPreview from '../components/BlogPostPreview.astro';
import { getCollection } from 'astro:content';

const avatarUrl = 'https://avatars.githubusercontent.com/u/11788389?v=4';

const allBlogPosts = await getCollection('blog', ({ data }) => {
	return !data.draft;
});

const latestPosts = allBlogPosts
	.sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
	.slice(0, 3);
---

<Layout>
	<main class="min-h-screen py-12">
		<div class="container mx-auto px-4 max-w-4xl">
			<!-- About Me Section -->
			<section class="mb-16">
				<div class="flex flex-col md:flex-row gap-8 items-start">
					<div class="avatar">
						<div class="w-32 rounded-full ring ring-base-300 ring-offset-base-100 ring-offset-2">
							<img src={avatarUrl} alt="Gerardo Báez" />
						</div>
					</div>
					<div class="flex-1">
						<h1 class="text-4xl font-bold mb-4">Gerardo Báez</h1>
						<p class="text-xl text-base-content/80 mb-4">Full Stack Web Developer</p>
						<p class="text-base-content/70 mb-6 leading-relaxed">
							I'm a full stack web developer freelancer & software engineer based in Puerto Rico. 
							I help businesses build modern web applications and digital solutions. 
							When I'm not coding, I share my thoughts and experiences on development, 
							freelancing, and technology.
						</p>
						<SocialLinks />
					</div>
				</div>
			</section>

			<!-- Latest Blog Posts Section -->
			<section>
				<div class="flex justify-between items-center mb-6">
					<h2 class="text-2xl font-bold">Latest Posts</h2>
					{latestPosts.length > 0 && (
						<a href="/blog" class="link link-hover text-sm">
							View all →
						</a>
					)}
				</div>
				<div class="space-y-4">
					{latestPosts.length > 0 ? (
						latestPosts.map((post) => (
							<BlogPostPreview
								title={post.data.title}
								excerpt={post.data.description}
								date={post.data.pubDate}
								slug={post.slug}
							/>
						))
					) : (
						<p class="text-base-content/60 italic">Blog posts coming soon...</p>
					)}
				</div>
			</section>
		</div>
	</main>
</Layout>
